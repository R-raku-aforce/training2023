mysql> select * from m_department;
+-----------------+-----------------+------------------+------------------+
| department_code | department_name | updated_datetime | created_datetime |
+-----------------+-----------------+------------------+------------------+
| 001             | 営業部          | NULL             | NULL             |
| 002             | システム部      | NULL             | NULL             |
| 003             | 開発部          | NULL             | NULL             |
| 004             | 経理部          | NULL             | NULL             |
| 005             | 総務部          | NULL             | NULL             |
+-----------------+-----------------+------------------+------------------+
5 rows in set (0.00 sec)

mysql> select * from employee;
+-------------+---------------+-----------------+---------------------+---------------------+
| employee_id | employee_name | department_code | updated_datetime    | created_datetime    |
+-------------+---------------+-----------------+---------------------+---------------------+
| 00001       | 山田太郎      | 001             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00002       | 田中花子      | 002             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00003       | 佐藤ひろし    | 003             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00004       | 吉田たかひろ  | 004             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00005       | 中田佳子      | 003             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00006       | 井上たかし    | 001             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00007       | 加藤浩子      | 001             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00008       | 和田剛        | 004             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00009       | 関口優        | 004             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
| 00010       | 山藤夏帆      | 003             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
+-------------+---------------+-----------------+---------------------+---------------------+
10 rows in set (0.00 sec)

mysql> select * from working_hours;
+--------------+-------------+----------------+------------------+------------------+
| working_date | employee_id | working_time_h | updated_datetime | created_datetime |
+--------------+-------------+----------------+------------------+------------------+
| 2020-06-01   | 00001       |            7.5 | NULL             | NULL             |
| 2020-06-01   | 00002       |            8.0 | NULL             | NULL             |
| 2020-06-01   | 00003       |           10.5 | NULL             | NULL             |
| 2020-06-01   | 00004       |            7.5 | NULL             | NULL             |
| 2020-06-01   | 00005       |            8.5 | NULL             | NULL             |
| 2020-06-01   | 00006       |            9.0 | NULL             | NULL             |
| 2020-06-01   | 00007       |           12.0 | NULL             | NULL             |
| 2020-06-01   | 00008       |            9.5 | NULL             | NULL             |
| 2020-06-01   | 00009       |            8.0 | NULL             | NULL             |
| 2020-06-01   | 00010       |            7.5 | NULL             | NULL             |
| 2020-06-02   | 00001       |            7.5 | NULL             | NULL             |
| 2020-06-02   | 00002       |            5.0 | NULL             | NULL             |
| 2020-06-02   | 00003       |           12.5 | NULL             | NULL             |
| 2020-06-02   | 00004       |            7.5 | NULL             | NULL             |
| 2020-06-02   | 00005       |           10.5 | NULL             | NULL             |
| 2020-06-02   | 00006       |           10.0 | NULL             | NULL             |
| 2020-06-02   | 00007       |            7.5 | NULL             | NULL             |
| 2020-06-02   | 00008       |            8.5 | NULL             | NULL             |
| 2020-06-02   | 00009       |            8.0 | NULL             | NULL             |
| 2020-06-02   | 00010       |            9.5 | NULL             | NULL             |
| 2020-06-03   | 00001       |            7.5 | NULL             | NULL             |
| 2020-06-03   | 00002       |            7.5 | NULL             | NULL             |
| 2020-06-03   | 00003       |           13.5 | NULL             | NULL             |
| 2020-06-03   | 00004       |            7.5 | NULL             | NULL             |
| 2020-06-03   | 00005       |            9.5 | NULL             | NULL             |
| 2020-06-03   | 00006       |           10.0 | NULL             | NULL             |
| 2020-06-03   | 00007       |           13.0 | NULL             | NULL             |
| 2020-06-03   | 00008       |            6.5 | NULL             | NULL             |
| 2020-06-03   | 00009       |            8.0 | NULL             | NULL             |
| 2020-06-03   | 00010       |            7.5 | NULL             | NULL             |
| 2020-06-04   | 00001       |            7.5 | NULL             | NULL             |
| 2020-06-04   | 00003       |           10.5 | NULL             | NULL             |
| 2020-06-04   | 00004       |            8.5 | NULL             | NULL             |
| 2020-06-04   | 00005       |           10.5 | NULL             | NULL             |
| 2020-06-04   | 00006       |           13.0 | NULL             | NULL             |
| 2020-06-04   | 00007       |           12.0 | NULL             | NULL             |
| 2020-06-04   | 00008       |            7.5 | NULL             | NULL             |
| 2020-06-04   | 00009       |            8.0 | NULL             | NULL             |
| 2020-06-04   | 00010       |            7.5 | NULL             | NULL             |
| 2020-06-05   | 00001       |            8.0 | NULL             | NULL             |
| 2020-06-05   | 00002       |           10.5 | NULL             | NULL             |
| 2020-06-05   | 00003       |           12.5 | NULL             | NULL             |
| 2020-06-05   | 00004       |            8.5 | NULL             | NULL             |
| 2020-06-05   | 00005       |           10.0 | NULL             | NULL             |
| 2020-06-05   | 00006       |           12.0 | NULL             | NULL             |
| 2020-06-05   | 00007       |           10.0 | NULL             | NULL             |
| 2020-06-05   | 00008       |            7.5 | NULL             | NULL             |
| 2020-06-05   | 00009       |            7.0 | NULL             | NULL             |
| 2020-06-05   | 00010       |           10.5 | NULL             | NULL             |
+--------------+-------------+----------------+------------------+------------------+
49 rows in set (0.00 sec)

mysql> select * from employee
    -> where employee_id = '00005';
+-------------+---------------+-----------------+---------------------+---------------------+
| employee_id | employee_name | department_code | updated_datetime    | created_datetime    |
+-------------+---------------+-----------------+---------------------+---------------------+
| 00005       | 中田佳子      | 003             | 2024-03-15 03:51:33 | 2024-03-15 03:51:33 |
+-------------+---------------+-----------------+---------------------+---------------------+
1 row in set (0.00 sec)

mysql> SELECT
    -> employee.employee_name
    -> , m_department.department_name
    -> FROM
    -> employee
    -> INNER JOIN
    -> m_department
    -> ON 
    -> employee.department_code = m_department.department_code;
+---------------+-----------------+
| employee_name | department_name |
+---------------+-----------------+
| 山田太郎      | 営業部          |
| 井上たかし    | 営業部          |
| 加藤浩子      | 営業部          |
| 田中花子      | システム部      |
| 佐藤ひろし    | 開発部          |
| 中田佳子      | 開発部          |
| 山藤夏帆      | 開発部          |
| 吉田たかひろ  | 経理部          |
| 和田剛        | 経理部          |
| 関口優        | 経理部          |
+---------------+-----------------+
10 rows in set (0.00 sec)

mysql> SELECT
    -> employee.employee_name
    -> , m.working_time_h
    -> FROM
    -> employee
    -> INNER JOIN
    -> (SELECT 
    -> *
    -> FROM
    -> working_hours
    -> WHERE 
    -> working_date > '2020-06-03'
    -> )AS m
    -> ON 
    -> employee.employee_id = m.employee_id;
+---------------+----------------+
| employee_name | working_time_h |
+---------------+----------------+
| 山田太郎      |            7.5 |
| 山田太郎      |            8.0 |
| 田中花子      |           10.5 |
| 佐藤ひろし    |           10.5 |
| 佐藤ひろし    |           12.5 |
| 吉田たかひろ  |            8.5 |
| 吉田たかひろ  |            8.5 |
| 中田佳子      |           10.5 |
| 中田佳子      |           10.0 |
| 井上たかし    |           13.0 |
| 井上たかし    |           12.0 |
| 加藤浩子      |           12.0 |
| 加藤浩子      |           10.0 |
| 和田剛        |            7.5 |
| 和田剛        |            7.5 |
| 関口優        |            8.0 |
| 関口優        |            7.0 |
| 山藤夏帆      |            7.5 |
| 山藤夏帆      |           10.5 |
+---------------+----------------+
19 rows in set (0.00 sec)

mysql> SELECT
    -> employee.employee_name
    -> , SUM(working_time_h) AS count
    -> FROM
    -> working_hours
    -> INNER JOIN
    -> employee
    -> ON 
    -> employee.employee_id = working_hours.employee_id
    -> GROUP BY
    -> employee.employee_name
    -> ORDER BY count DESC;
+---------------+-------+
| employee_name | count |
+---------------+-------+
| 佐藤ひろし    |  59.5 |
| 加藤浩子      |  54.5 |
| 井上たかし    |  54.0 |
| 中田佳子      |  49.0 |
| 山藤夏帆      |  42.5 |
| 吉田たかひろ  |  39.5 |
| 和田剛        |  39.5 |
| 関口優        |  39.0 |
| 山田太郎      |  38.0 |
| 田中花子      |  31.0 |
+---------------+-------+
10 rows in set (0.00 sec)

mysql> SELECT
    -> employee.department_code
    -> , AVG(working_time_h) AS avgcount
    -> FROM
    -> working_hours
    -> INNER JOIN
    -> employee
    -> ON 
    -> employee.employee_id = working_hours.employee_id
    -> GROUP BY
    -> employee.department_code
    -> ORDER BY avgcount ASC;
+-----------------+----------+
| department_code | avgcount |
+-----------------+----------+
| 002             |  7.75000 |
| 004             |  7.86667 |
| 001             |  9.76667 |
| 003             | 10.06667 |
+-----------------+----------+
4 rows in set (0.00 sec)

mysql> notee
